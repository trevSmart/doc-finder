<!doctype html>
<html lang="ca">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" href="/favicon.png" />
    <title>Document Finder - Base de Coneixement Vodafone PYME</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        --primary-blue: #1e40af;
        --secondary-blue: #3b82f6;
        --light-blue: #dbeafe;
        --dark-blue: #1e3a8a;
        --teal: #14b8a6;
        --gray-50: #f9fafb;
        --gray-100: #f3f4f6;
        --gray-200: #e5e7eb;
        --gray-300: #d1d5db;
        --gray-400: #9ca3af;
        --gray-500: #6b7280;
        --gray-600: #4b5563;
        --gray-700: #374151;
        --gray-800: #1f2937;
        --gray-900: #111827;
        --white: #ffffff;
        --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        --shadow-md:
          0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        --shadow-lg:
          0 10px 15px -3px rgba(0, 0, 0, 0.1),
          0 4px 6px -2px rgba(0, 0, 0, 0.05);
        --shadow-xl:
          0 20px 25px -5px rgba(0, 0, 0, 0.1),
          0 10px 10px -5px rgba(0, 0, 0, 0.04);
      }

      body {
        font-family:
          "Inter",
          -apple-system,
          BlinkMacSystemFont,
          "Segoe UI",
          Roboto,
          sans-serif;
        background:
          radial-gradient(
            ellipse 120% 80% at 20% 30%,
            #1e3a8a 0%,
            transparent 60%
          ),
          radial-gradient(
            ellipse 100% 120% at 80% 70%,
            #1e40af 0%,
            transparent 50%
          ),
          radial-gradient(
            ellipse 80% 100% at 50% 20%,
            #3b82f6 0%,
            transparent 40%
          ),
          radial-gradient(
            ellipse 90% 110% at 10% 80%,
            #1e3a8a 0%,
            transparent 45%
          ),
          radial-gradient(
            ellipse 110% 90% at 70% 10%,
            #1e40af 0%,
            transparent 55%
          ),
          linear-gradient(135deg, #1e3a8a 0%, #1e40af 50%, #3b82f6 100%);
        color: var(--gray-800);
        line-height: 1.6;
        min-height: 100vh;
        position: relative;
        overflow-x: hidden;
      }

      body.resizing {
        cursor: col-resize;
        user-select: none;
      }

      body.resizing * {
        user-select: none !important;
      }

      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background:
          radial-gradient(
            circle at 20% 80%,
            rgba(20, 184, 166, 0.1) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 20%,
            rgba(59, 130, 246, 0.1) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 40% 40%,
            rgba(30, 64, 175, 0.05) 0%,
            transparent 50%
          );
        pointer-events: none;
        z-index: -1;
      }

      .app-container {
        display: flex;
        min-height: 100vh;
        padding: 20px;
        gap: 20px;
      }

      /* Left Column - Navigation */
      .sidebar {
        width: 280px;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 20px;
        box-shadow:
          0 8px 32px rgba(0, 0, 0, 0.1),
          0 0 0 1px rgba(255, 255, 255, 0.1);
        overflow-y: auto;
        flex-shrink: 0;
        position: relative;
        transition:
          width 0.3s ease,
          padding 0.3s ease,
          margin 0.3s ease,
          opacity 0.25s ease,
          border 0.3s ease,
          box-shadow 0.3s ease;
      }

      .sidebar-header {
        padding: 24px 20px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        background: linear-gradient(
          135deg,
          rgba(30, 64, 175, 0.9) 0%,
          rgba(59, 130, 246, 0.9) 100%
        );
        color: var(--white);
        border-radius: 20px 20px 0 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .sidebar-logo {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 8px;
      }

      .logo-icon {
        width: 32px;
        height: 32px;
        background: var(--teal);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        color: var(--white);
      }

      .sidebar-title {
        font-size: 18px;
        font-weight: 600;
        margin: 0;
      }

      .sidebar-subtitle {
        font-size: 14px;
        opacity: 0.9;
        margin: 0;
      }

      .sidebar-toggle {
        background: none;
        border: none;
        color: var(--white);
        cursor: pointer;
        padding: 8px;
        border-radius: 8px;
        transition: all 0.2s ease;
        opacity: 0.8;
      }

      .sidebar-toggle:hover {
        background: rgba(255, 255, 255, 0.1);
        opacity: 1;
      }

      .sidebar-toggle svg {
        transition: transform 0.3s ease;
      }

      /* Sidebar minimitzat */
      .sidebar.minimized {
        width: 0;
        min-width: 0;
        overflow: hidden;
        padding: 0;
        border: none;
        box-shadow: none;
        opacity: 0;
        pointer-events: none;
        margin-right: -20px;
        visibility: hidden;
      }

      .sidebar.minimized .sidebar-logo {
        justify-content: center;
      }

      .sidebar.minimized .sidebar-logo > div:not(.logo-icon) {
        display: none;
      }

      .sidebar.minimized .sidebar-nav {
        display: none;
      }

      .sidebar.minimized .sidebar-toggle svg {
        transform: rotate(180deg);
      }

      /* Panell de previsualitzaci√≥ minimitzat */
      .right-panel.minimized {
        width: 0;
        min-width: 0;
        overflow: hidden;
        padding: 0;
        border: none;
        box-shadow: none;
        opacity: 0;
        pointer-events: none;
        margin-left: -20px;
      }

      .right-panel.minimized .panel-content,
      .right-panel.minimized .panel-header {
        display: none;
      }

      .right-panel.minimized .panel-minimize svg {
        transform: rotate(180deg);
      }

      .sidebar-nav {
        padding: 20px 0;
      }

      .nav-section {
        margin-bottom: 32px;
      }

      .nav-section-title {
        font-size: 12px;
        font-weight: 600;
        color: var(--gray-500);
        text-transform: uppercase;
        letter-spacing: 0.05em;
        padding: 0 20px 8px;
        margin-bottom: 8px;
      }

      .nav-item {
        display: flex;
        align-items: center;
        padding: 12px 20px;
        color: var(--gray-600);
        text-decoration: none;
        transition: all 0.2s ease;
        border-left: 3px solid transparent;
      }

      .nav-item:hover {
        background: var(--gray-50);
        color: var(--gray-800);
        border-left-color: var(--secondary-blue);
      }

      .nav-item.active {
        background: var(--light-blue);
        color: var(--primary-blue);
        border-left-color: var(--primary-blue);
        font-weight: 500;
      }

      .nav-icon {
        width: 20px;
        height: 20px;
        margin-right: 12px;
        opacity: 0.7;
      }

      /* Main Content */
      /* Center Column - Main Content */
      .main-content {
        flex: 1;
        background: transparent;
        border: none;
        border-radius: 0;
        box-shadow: none;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        gap: 32px;
        transition: margin 0.3s ease;
      }

      .primary-controls {
        display: flex;
        flex-direction: column;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 20px;
        box-shadow:
          0 8px 32px rgba(0, 0, 0, 0.1),
          0 0 0 1px rgba(255, 255, 255, 0.1);
        overflow: hidden;
      }

      /* Expandir contingut quan els panells estan minimitzats */
      .app-container.sidebar-minimized .main-content {
        margin-left: 0;
      }

      .app-container.right-panel-minimized .main-content {
        margin-right: 0;
      }

      .app-container.right-panel-minimized .panel-resizer {
        display: none;
      }

      /* Quan tots dos panells estan minimitzats */
      .app-container.sidebar-minimized.right-panel-minimized .main-content {
        margin-left: 0;
        margin-right: 0;
      }

      .header {
        background: rgba(255, 255, 255, 0.8);
        backdrop-filter: blur(20px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        padding: 24px 32px;
        border-radius: 20px 20px 0 0;
      }

      .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .header-title {
        font-size: 28px;
        font-weight: 600;
        color: var(--gray-900);
        margin: 0;
      }

      .header-subtitle {
        font-size: 16px;
        color: var(--gray-600);
        margin: 4px 0 0;
      }

      .back-btn {
        background: var(--gray-100);
        color: var(--gray-600);
        border: none;
        padding: 10px 16px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .back-btn:hover {
        background: var(--gray-200);
        color: var(--gray-800);
      }

      .search-section {
        padding: 32px;
        background: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(20px);
        border-top: 1px solid rgba(255, 255, 255, 0.2);
      }

      .search-container {
        display: flex;
        gap: 16px;
        margin-bottom: 24px;
        flex-wrap: wrap;
        align-items: center;
      }

      .search-input {
        flex: 1;
        min-width: 320px;
        padding: 16px 20px;
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 12px;
        font-size: 16px;
        font-weight: 400;
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(20px);
        transition: all 0.2s ease;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
      }

      .search-input:focus {
        outline: none;
        border-color: var(--secondary-blue);
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        background: rgba(255, 255, 255, 0.95);
      }

      .search-input::placeholder {
        color: var(--gray-400);
      }

      .filter-container {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
      }

      .filter-select {
        padding: 12px 16px;
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 8px;
        font-size: 14px;
        font-weight: 500;
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(20px);
        min-width: 160px;
        color: var(--gray-700);
        transition: all 0.2s ease;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
      }

      .filter-select:focus {
        outline: none;
        border-color: var(--secondary-blue);
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }

      .results-section {
        padding: 32px;
        width: 100%;
        transition: width 0.3s ease;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 20px;
        box-shadow:
          0 8px 32px rgba(0, 0, 0, 0.1),
          0 0 0 1px rgba(255, 255, 255, 0.1);
      }

      .results-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 32px;
      }

      .results-count {
        font-size: 16px;
        font-weight: 500;
        color: var(--gray-600);
      }

      .view-toggle {
        display: flex;
        gap: 8px;
        background: var(--gray-100);
        padding: 4px;
        border-radius: 8px;
      }

      .view-btn {
        padding: 8px 16px;
        border: none;
        background: transparent;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
        color: var(--gray-600);
        transition: all 0.2s ease;
      }

      .view-btn.active {
        background: var(--white);
        color: var(--primary-blue);
        box-shadow: var(--shadow-sm);
      }

      .processes-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(420px, 1fr));
        gap: 24px;
      }

      .process-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 16px;
        padding: 24px;
        transition: all 0.3s ease;
        cursor: pointer;
        box-shadow:
          0 8px 32px rgba(0, 0, 0, 0.1),
          0 0 0 1px rgba(255, 255, 255, 0.1);
        position: relative;
        overflow: hidden;
      }

      .process-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--secondary-blue), var(--teal));
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .process-card:hover {
        transform: translateY(-8px);
        box-shadow:
          0 20px 40px rgba(0, 0, 0, 0.15),
          0 0 0 1px rgba(255, 255, 255, 0.2);
        border-color: rgba(59, 130, 246, 0.3);
      }

      .process-card:hover::before {
        opacity: 1;
      }

      .process-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 16px;
      }

      .process-name {
        font-size: 20px;
        font-weight: 600;
        color: var(--gray-900);
        margin-bottom: 8px;
        line-height: 1.3;
      }

      .process-description {
        color: var(--gray-600);
        font-size: 15px;
        line-height: 1.5;
        margin-bottom: 20px;
      }

      .priority-badge {
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .priority-critical {
        background: #fef2f2;
        color: #dc2626;
        border: 1px solid #fecaca;
      }

      .priority-high {
        background: #fff7ed;
        color: #ea580c;
        border: 1px solid #fed7aa;
      }

      .priority-medium {
        background: #fffbeb;
        color: #d97706;
        border: 1px solid #fde68a;
      }

      .priority-low {
        background: #f0fdf4;
        color: #16a34a;
        border: 1px solid #bbf7d0;
      }

      .process-details {
        margin-bottom: 20px;
      }

      .detail-row {
        display: flex;
        margin-bottom: 12px;
        font-size: 14px;
        align-items: center;
      }

      .detail-label {
        font-weight: 600;
        color: var(--gray-700);
        min-width: 100px;
        margin-right: 12px;
      }

      .detail-value {
        color: var(--gray-600);
        flex: 1;
      }

      .tags-container {
        margin-top: 20px;
      }

      .tags-title {
        font-size: 14px;
        font-weight: 600;
        color: var(--gray-700);
        margin-bottom: 12px;
      }

      .tags {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
      }

      .tag {
        background: var(--gray-100);
        color: var(--gray-700);
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
        border: 1px solid var(--gray-200);
      }

      .tag:hover {
        background: var(--secondary-blue);
        color: var(--white);
        border-color: var(--secondary-blue);
        transform: translateY(-1px);
      }

      .diagram-section {
        margin-top: 24px;
        text-align: center;
      }

      .diagram-placeholder {
        background: var(--gray-50);
        border: 2px dashed var(--gray-300);
        border-radius: 12px;
        padding: 40px;
        color: var(--gray-500);
        font-style: italic;
        font-size: 14px;
      }

      .diagram-image {
        max-width: 100%;
        border-radius: 12px;
        box-shadow: var(--shadow-md);
        transition: transform 0.2s ease;
      }

      .diagram-image:hover {
        transform: scale(1.02);
      }

      .no-results {
        text-align: center;
        padding: 80px 20px;
        color: var(--gray-500);
      }

      .no-results h3 {
        font-size: 24px;
        font-weight: 600;
        margin-bottom: 12px;
        color: var(--gray-700);
      }

      .no-results p {
        font-size: 16px;
        color: var(--gray-500);
      }

      /* Modal */
      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(4px);
      }

      .modal-content {
        position: relative;
        margin: 5% auto;
        width: 90%;
        max-width: 1200px;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 20px;
        overflow: hidden;
        box-shadow:
          0 20px 60px rgba(0, 0, 0, 0.3),
          0 0 0 1px rgba(255, 255, 255, 0.1);
      }

      .modal-header {
        background: linear-gradient(
          135deg,
          rgba(30, 64, 175, 0.9) 0%,
          rgba(59, 130, 246, 0.9) 100%
        );
        color: var(--white);
        padding: 24px 32px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .modal-header h2 {
        font-size: 20px;
        font-weight: 600;
        margin: 0;
      }

      .modal-body {
        padding: 32px;
        max-height: 70vh;
        overflow-y: auto;
      }

      .close {
        color: var(--white);
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
        opacity: 0.8;
        transition: opacity 0.2s ease;
      }

      .close:hover {
        opacity: 1;
      }

      /* Right Column - Preview Panel */
      .right-panel {
        width: 400px;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 20px;
        box-shadow:
          0 8px 32px rgba(0, 0, 0, 0.1),
          0 0 0 1px rgba(255, 255, 255, 0.1);
        overflow-y: auto;
        flex-shrink: 0;
        position: relative;
        transition:
          width 0.3s ease,
          padding 0.3s ease,
          margin 0.3s ease,
          opacity 0.25s ease,
          border 0.3s ease,
          box-shadow 0.3s ease;
      }

      .panel-header {
        background: linear-gradient(
          135deg,
          rgba(30, 64, 175, 0.9) 0%,
          rgba(59, 130, 246, 0.9) 100%
        );
        color: var(--white);
        padding: 24px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 20px 20px 0 0;
      }

      .panel-header h3 {
        font-size: 18px;
        font-weight: 600;
        margin: 0;
      }

      .panel-controls {
        display: flex;
        gap: 8px;
        align-items: center;
      }

      .panel-minimize {
        background: none;
        border: none;
        color: var(--white);
        cursor: pointer;
        padding: 8px;
        border-radius: 8px;
        transition: all 0.2s ease;
        opacity: 0.8;
      }

      .panel-minimize:hover {
        background: rgba(255, 255, 255, 0.1);
        opacity: 1;
      }

      .panel-minimize svg {
        transition: transform 0.3s ease;
      }

      .panel-close {
        background: none;
        border: none;
        color: var(--white);
        font-size: 24px;
        cursor: pointer;
        opacity: 0.8;
        transition: opacity 0.2s ease;
      }

      .panel-close:hover {
        opacity: 1;
      }

      .panel-content {
        padding: 24px;
      }

      .panel-resizer {
        position: absolute;
        top: 0;
        left: -12px;
        width: 16px;
        height: 100%;
        cursor: col-resize;
        display: flex;
        align-items: center;
        justify-content: center;
        pointer-events: auto;
        opacity: 0.2;
        transition: opacity 0.2s ease;
        z-index: 2;
        touch-action: none;
      }

      .panel-resizer::before {
        content: "";
        width: 4px;
        height: 48px;
        border-radius: 999px;
        background: linear-gradient(180deg, var(--secondary-blue), var(--teal));
      }

      .panel-toggle-button {
        position: fixed;
        top: 50%;
        transform: translateY(-50%);
        background: rgba(255, 255, 255, 0.95);
        border: 1px solid rgba(255, 255, 255, 0.6);
        border-radius: 999px;
        padding: 10px;
        box-shadow:
          0 8px 16px rgba(0, 0, 0, 0.12),
          0 0 0 1px rgba(255, 255, 255, 0.4);
        display: inline-flex;
        align-items: center;
        justify-content: center;
        color: var(--primary-blue);
        cursor: pointer;
        z-index: 1100;
        transition:
          transform 0.2s ease,
          box-shadow 0.2s ease,
          opacity 0.2s ease;
      }

      .panel-toggle-button:hover {
        transform: translateY(-50%) scale(1.05);
        box-shadow:
          0 10px 20px rgba(0, 0, 0, 0.18),
          0 0 0 1px rgba(59, 130, 246, 0.4);
      }

      .panel-toggle-button svg {
        width: 18px;
        height: 18px;
      }

      .sidebar-open-btn {
        left: 16px;
      }

      .right-panel-open-btn {
        right: 16px;
      }

      .panel-resizer:hover,
      .panel-resizer.active {
        opacity: 0.9;
      }

      .right-panel.minimized .panel-resizer {
        display: none;
      }

      /* Mobile Responsive */
      @media (max-width: 768px) {
        .app-container {
          padding: 10px;
          gap: 10px;
        }

        .sidebar {
          width: 100%;
        }

        .search-container {
          flex-direction: column;
        }

        .search-input {
          min-width: auto;
        }

        .processes-grid {
          grid-template-columns: 1fr;
        }

        .filter-container {
          flex-direction: column;
        }

        .right-panel {
          width: 100%;
        }

        .panel-resizer {
          display: none !important;
        }

        .panel-toggle-button {
          top: auto;
          bottom: 24px;
          transform: none;
        }

        .panel-toggle-button:hover {
          transform: scale(1.05);
        }

        .sidebar-open-btn {
          left: 20px;
        }

        .right-panel-open-btn {
          right: 20px;
        }

        .header {
          padding: 16px 20px;
        }

        .header-title {
          font-size: 24px;
        }

        .search-section {
          padding: 20px;
        }

        .results-section {
          padding: 20px;
        }
      }
    </style>
  </head>
  <body>
    <div class="app-container">
      <!-- Sidebar Toggle Button -->

      <!-- Sidebar -->
      <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
          <div class="sidebar-logo">
            <div class="logo-icon">doc-finder</div>
            <div>
              <h1 class="sidebar-title">Vodafone PYME</h1>
              <p class="sidebar-subtitle">Base de Coneixement</p>
            </div>
          </div>
          <button
            class="sidebar-toggle"
            onclick="toggleSidebar()"
            title="Minimitzar sidebar"
          >
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M9 18l6-6-6-6" />
            </svg>
          </button>
        </div>

        <nav class="sidebar-nav">
          <div class="nav-section">
            <div class="nav-section-title">Navegaci√≥ Principal</div>
            <a href="#" class="nav-item active">
              <svg
                class="nav-icon"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                ></path>
              </svg>
              Cerca Documents
            </a>
            <a href="../diagrams/" class="nav-item">
              <svg
                class="nav-icon"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
                ></path>
              </svg>
              Diagrames
            </a>
            <a href="../business-processes/" class="nav-item">
              <svg
                class="nav-icon"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"
                ></path>
              </svg>
              Processos de Negoci
            </a>
          </div>

          <div class="nav-section">
            <div class="nav-section-title">Categories</div>
            <a
              href="#"
              class="nav-item"
              onclick="filterByCategory('Schedulable')"
            >
              <svg
                class="nav-icon"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
                ></path>
              </svg>
              Schedulable
            </a>
            <a
              href="#"
              class="nav-item"
              onclick="filterByCategory('Batchable')"
            >
              <svg
                class="nav-icon"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"
                ></path>
              </svg>
              Batchable
            </a>
            <a
              href="#"
              class="nav-item"
              onclick="filterByCategory('Omniscript')"
            >
              <svg
                class="nav-icon"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                ></path>
              </svg>
              Omniscript
            </a>
            <a href="#" class="nav-item" onclick="filterByCategory('Approval')">
              <svg
                class="nav-icon"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
                ></path>
              </svg>
              Approval
            </a>
          </div>

          <div class="nav-section">
            <div class="nav-section-title">Integracions</div>
            <a
              href="#"
              class="nav-item"
              onclick="filterByIntegration('Platform Events')"
            >
              <svg
                class="nav-icon"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M13 10V3L4 14h7v7l9-11h-7z"
                ></path>
              </svg>
              Platform Events
            </a>
            <a
              href="#"
              class="nav-item"
              onclick="filterByIntegration('External API')"
            >
              <svg
                class="nav-icon"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
                ></path>
              </svg>
              External API
            </a>
          </div>
        </nav>
      </div>

      <!-- Main Content -->
      <div class="main-content">
        <div class="primary-controls">
          <div class="header">
            <div class="header-content">
              <div>
                <h1 class="header-title">Base de Coneixement</h1>
                <p class="header-subtitle">Processos de Negoci Vodafone PYME</p>
              </div>
              <button class="back-btn" onclick="goBack()">
                <svg
                  width="16"
                  height="16"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M10 19l-7-7m0 0l7-7m-7 7h18"
                  ></path>
                </svg>
                Tornar
              </button>
            </div>
          </div>

          <div class="search-section">
            <input
              type="text"
              id="searchInput"
              class="search-input"
              placeholder="Cerca per nom, descripci√≥, objecte, integraci√≥, mecanisme..."
            />

            <div class="filter-container">
              <select id="categoryFilter" class="filter-select">
                <option value="">Totes les categories</option>
              </select>

              <select id="mechanismFilter" class="filter-select">
                <option value="">Tots els mecanismes</option>
              </select>

              <select id="objectFilter" class="filter-select">
                <option value="">Tots els objectes</option>
              </select>

              <select id="integrationFilter" class="filter-select">
                <option value="">Totes les integracions</option>
              </select>
            </div>
          </div>
        </div>

        <div class="results-section" id="resultsSection">
          <div class="results-header">
            <div class="results-count" id="resultsCount">Carregant...</div>
            <div class="view-toggle">
              <button class="view-btn active" onclick="setView('grid')">
                Grid
              </button>
              <button class="view-btn" onclick="setView('list')">Llista</button>
            </div>
          </div>

          <div id="processesContainer" class="processes-grid">
            <!-- Els processos es carregaran aqu√≠ -->
          </div>
        </div>
      </div>

      <!-- Right Column - Preview Panel -->
      <div class="right-panel" id="rightPanel">
        <div
          class="panel-resizer"
          id="rightPanelResizer"
          title="Arrossega per redimensionar"
        ></div>
        <div class="panel-header">
          <h3 id="panelTitle">Documentaci√≥</h3>
          <div class="panel-controls">
            <button
              class="panel-minimize"
              onclick="toggleRightPanel()"
              title="Minimitzar panell"
            >
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M15 18l-6-6 6-6" />
              </svg>
            </button>
            <button
              class="panel-close"
              onclick="closePanel()"
              title="Tancar panell"
            >
              &times;
            </button>
          </div>
        </div>
        <div class="panel-content" id="panelContent">
          <p>Selecciona un proc√©s per veure la seva documentaci√≥.</p>
        </div>
      </div>
    </div>

    <button
      type="button"
      id="sidebarOpenButton"
      class="panel-toggle-button sidebar-open-btn"
      onclick="openSidebar()"
      aria-label="Mostrar navegaci√≥"
      hidden
    >
      <svg
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M10 6l6 6-6 6"
        />
      </svg>
    </button>

    <button
      type="button"
      id="rightPanelOpenButton"
      class="panel-toggle-button right-panel-open-btn"
      onclick="openRightPanel()"
      aria-label="Mostrar panell de previsualitzaci√≥"
      hidden
    >
      <svg
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M14 6l-6 6 6 6"
        />
      </svg>
    </button>

    <!-- Modal per visualitzar diagrames -->
    <div id="diagramModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="modalTitle">Diagrama</h2>
          <span class="close" onclick="closeModal()">&times;</span>
        </div>
        <div class="modal-body">
          <img id="modalImage" class="diagram-image" src="" alt="Diagrama" />
        </div>
      </div>
    </div>

    <script>
      let processesData = [];
      let filteredProcesses = [];
      let currentView = "grid";
      const RIGHT_PANEL_MIN_WIDTH = 280;
      const RIGHT_PANEL_MAX_WIDTH = 720;
      const RIGHT_PANEL_DEFAULT_WIDTH = 400;

      function goBack() {
        if (window.history.length > 1) {
          window.history.back();
        } else {
          window.location.href = "../";
        }
      }

      function openPanel(title, content) {
        openRightPanel();
        document.getElementById("panelTitle").textContent = title;
        document.getElementById("panelContent").innerHTML = content;
      }

      function closePanel() {
        document.getElementById("panelTitle").textContent = "Documentaci√≥";
        document.getElementById("panelContent").innerHTML =
          "<p>Selecciona un proc√©s per veure la seva documentaci√≥.</p>";
        closeRightPanel();
      }

      // Funcions per minimitzar/expandir panells
      function toggleSidebar() {
        const sidebar = document.getElementById("sidebar");
        if (!sidebar) {
          return;
        }

        setSidebarMinimized(!sidebar.classList.contains("minimized"));
      }

      function setSidebarMinimized(minimize, options = {}) {
        const { skipStateSave = false } = options;
        const sidebar = document.getElementById("sidebar");
        const appContainer = document.querySelector(".app-container");
        const sidebarOpenButton = document.getElementById("sidebarOpenButton");

        if (!sidebar || !appContainer) {
          return;
        }

        sidebar.classList.toggle("minimized", minimize);
        appContainer.classList.toggle("sidebar-minimized", minimize);

        if (sidebarOpenButton) {
          sidebarOpenButton.hidden = !minimize;
        }

        if (!skipStateSave) {
          localStorage.setItem("sidebarMinimized", minimize);
        }
      }

      function openSidebar() {
        setSidebarMinimized(false);
      }

      function toggleRightPanel() {
        const rightPanel = document.getElementById("rightPanel");
        if (!rightPanel) {
          return;
        }

        setRightPanelMinimized(!rightPanel.classList.contains("minimized"));
      }

      function setRightPanelMinimized(minimize, options = {}) {
        const { skipStateSave = false, skipWidthSave = false } = options;
        const rightPanel = document.getElementById("rightPanel");
        const appContainer = document.querySelector(".app-container");
        const rightPanelOpenButton = document.getElementById(
          "rightPanelOpenButton"
        );

        if (!rightPanel || !appContainer) {
          return;
        }

        if (minimize) {
          if (!skipWidthSave) {
            const currentWidth = Math.round(
              rightPanel.getBoundingClientRect().width
            );
            if (currentWidth) {
              const clampedWidth = Math.max(
                RIGHT_PANEL_MIN_WIDTH,
                Math.min(RIGHT_PANEL_MAX_WIDTH, currentWidth)
              );
              localStorage.setItem("rightPanelWidth", clampedWidth);
            }
          }

          rightPanel.classList.add("minimized");
          rightPanel.style.width = "0px";
          appContainer.classList.add("right-panel-minimized");

          if (rightPanelOpenButton) {
            rightPanelOpenButton.hidden = false;
          }
        } else {
          rightPanel.classList.remove("minimized");
          appContainer.classList.remove("right-panel-minimized");
          applyStoredRightPanelWidth();

          if (rightPanelOpenButton) {
            rightPanelOpenButton.hidden = true;
          }
        }

        if (!skipStateSave) {
          localStorage.setItem("rightPanelMinimized", minimize);
        }
      }

      function openRightPanel() {
        setRightPanelMinimized(false);
      }

      function closeRightPanel() {
        setRightPanelMinimized(true);
      }

      // Restaurar estats dels panells al carregar la p√†gina
      function restorePanelStates() {
        const sidebarMinimized =
          localStorage.getItem("sidebarMinimized") === "true";
        const rightPanelMinimized =
          localStorage.getItem("rightPanelMinimized") === "true";

        setSidebarMinimized(sidebarMinimized, { skipStateSave: true });
        setRightPanelMinimized(rightPanelMinimized, {
          skipStateSave: true,
          skipWidthSave: true
        });
      }

      function applyStoredRightPanelWidth() {
        const rightPanel = document.getElementById("rightPanel");
        if (!rightPanel || rightPanel.classList.contains("minimized")) {
          return;
        }

        let widthToApply = parseInt(
          localStorage.getItem("rightPanelWidth"),
          10
        );

        if (Number.isNaN(widthToApply) || widthToApply <= 0) {
          widthToApply = RIGHT_PANEL_DEFAULT_WIDTH;
        }

        widthToApply = Math.min(
          Math.max(widthToApply, RIGHT_PANEL_MIN_WIDTH),
          RIGHT_PANEL_MAX_WIDTH
        );
        rightPanel.style.width = `${widthToApply}px`;
      }

      function initRightPanelResize() {
        const resizer = document.getElementById("rightPanelResizer");
        const rightPanel = document.getElementById("rightPanel");

        if (!resizer || !rightPanel) {
          return;
        }

        let isResizing = false;
        let startX = 0;
        let startWidth = 0;

        const getClientX = (event) => {
          if (event.touches && event.touches.length > 0) {
            return event.touches[0].clientX;
          }
          return event.clientX;
        };

        const onPointerMove = (event) => {
          if (!isResizing) {
            return;
          }

          const clientX = getClientX(event);
          if (typeof clientX !== "number") {
            return;
          }

          const delta = startX - clientX;
          let newWidth = startWidth + delta;
          newWidth = Math.max(
            RIGHT_PANEL_MIN_WIDTH,
            Math.min(RIGHT_PANEL_MAX_WIDTH, newWidth)
          );

          rightPanel.style.width = `${newWidth}px`;
          localStorage.setItem("rightPanelWidth", Math.round(newWidth));

          event.preventDefault();
        };

        const stopResize = () => {
          if (!isResizing) {
            return;
          }

          const finalWidth = Math.round(
            rightPanel.getBoundingClientRect().width
          );
          if (finalWidth) {
            const clampedWidth = Math.max(
              RIGHT_PANEL_MIN_WIDTH,
              Math.min(RIGHT_PANEL_MAX_WIDTH, finalWidth)
            );
            localStorage.setItem("rightPanelWidth", clampedWidth);
          }

          isResizing = false;
          resizer.classList.remove("active");
          document.body.classList.remove("resizing");

          document.removeEventListener("mousemove", onPointerMove);
          document.removeEventListener("mouseup", stopResize);
          document.removeEventListener("touchmove", onPointerMove);
          document.removeEventListener("touchend", stopResize);
          document.removeEventListener("touchcancel", stopResize);
        };

        const startResize = (event) => {
          if (rightPanel.classList.contains("minimized")) {
            return;
          }

          startX = getClientX(event);
          if (typeof startX !== "number") {
            return;
          }

          isResizing = true;
          startWidth = rightPanel.getBoundingClientRect().width;

          resizer.classList.add("active");
          document.body.classList.add("resizing");

          document.addEventListener("mousemove", onPointerMove);
          document.addEventListener("mouseup", stopResize);
          document.addEventListener("touchmove", onPointerMove, {
            passive: false
          });
          document.addEventListener("touchend", stopResize);
          document.addEventListener("touchcancel", stopResize);

          event.preventDefault();
        };

        resizer.addEventListener("mousedown", startResize);
        resizer.addEventListener("touchstart", startResize, { passive: false });
      }

      // Carregar dades
      async function loadData() {
        try {
          const response = await fetch("processes-database.json");
          const data = await response.json();
          processesData = data.processes;
          filteredProcesses = [...processesData];

          populateFilters(data);
          renderProcesses();
          updateResultsCount();
        } catch (error) {
          console.error("Error carregant dades:", error);
          document.getElementById("processesContainer").innerHTML =
            '<div class="no-results"><h3>Error carregant dades</h3><p>No es poden carregar els processos.</p></div>';
        }
      }

      // Omplir filtres
      function populateFilters(data) {
        const categorySelect = document.getElementById("categoryFilter");
        const mechanismSelect = document.getElementById("mechanismFilter");
        const objectSelect = document.getElementById("objectFilter");
        const integrationSelect = document.getElementById("integrationFilter");

        data.categories.forEach((category) => {
          const option = document.createElement("option");
          option.value = category;
          option.textContent = category;
          categorySelect.appendChild(option);
        });

        data.mechanisms.forEach((mechanism) => {
          const option = document.createElement("option");
          option.value = mechanism;
          option.textContent = mechanism;
          mechanismSelect.appendChild(option);
        });

        data.objects.forEach((object) => {
          const option = document.createElement("option");
          option.value = object;
          option.textContent = object;
          objectSelect.appendChild(option);
        });

        data.integrations.forEach((integration) => {
          const option = document.createElement("option");
          option.value = integration;
          option.textContent = integration;
          integrationSelect.appendChild(option);
        });
      }

      // Cerca i filtratge
      function filterProcesses() {
        const searchTerm = document
          .getElementById("searchInput")
          .value.toLowerCase();
        const categoryFilter = document.getElementById("categoryFilter").value;
        const mechanismFilter =
          document.getElementById("mechanismFilter").value;
        const objectFilter = document.getElementById("objectFilter").value;
        const integrationFilter =
          document.getElementById("integrationFilter").value;

        filteredProcesses = processesData.filter((process) => {
          // Cerca de text
          const matchesSearch =
            !searchTerm ||
            process.name.toLowerCase().includes(searchTerm) ||
            process.description.toLowerCase().includes(searchTerm) ||
            process.tags.some((tag) =>
              tag.toLowerCase().includes(searchTerm)
            ) ||
            process.objects.some((obj) =>
              obj.toLowerCase().includes(searchTerm)
            ) ||
            process.integrations.some((int) =>
              int.toLowerCase().includes(searchTerm)
            ) ||
            process.mechanism.toLowerCase().includes(searchTerm);

          // Filtres
          const matchesCategory =
            !categoryFilter || process.category === categoryFilter;
          const matchesMechanism =
            !mechanismFilter || process.mechanism === mechanismFilter;
          const matchesObject =
            !objectFilter || process.objects.includes(objectFilter);
          const matchesIntegration =
            !integrationFilter ||
            process.integrations.includes(integrationFilter);

          return (
            matchesSearch &&
            matchesCategory &&
            matchesMechanism &&
            matchesObject &&
            matchesIntegration
          );
        });

        renderProcesses();
        updateResultsCount();
      }

      // Renderitzar processos
      function renderProcesses() {
        const container = document.getElementById("processesContainer");

        if (filteredProcesses.length === 0) {
          container.innerHTML =
            '<div class="no-results"><h3>No s\'han trobat resultats</h3><p>Prova amb altres criteris de cerca.</p></div>';
          return;
        }

        const viewClass =
          currentView === "grid" ? "processes-grid" : "processes-list";
        container.className = viewClass;

        container.innerHTML = filteredProcesses
          .map(
            (process) => `
                <div class="process-card" onclick="showProcessDetails('${process.id}')">
                    <div class="process-header">
                        <div>
                            <div class="process-name">${process.name}</div>
                        </div>
                        <div class="priority-badge priority-${process.priority}">${process.priority}</div>
                    </div>

                    <div class="process-description">${process.description}</div>

                    <div class="process-details">
                        <div class="detail-row">
                            <span class="detail-label">Categoria:</span>
                            <span class="detail-value">${process.category}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Mecanisme:</span>
                            <span class="detail-value">${process.mechanism}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Objectes:</span>
                            <span class="detail-value">${process.objects.join(", ")}</span>
                        </div>
                        ${
                          process.integrations.length > 0
                            ? `
                        <div class="detail-row">
                            <span class="detail-label">Integracions:</span>
                            <span class="detail-value">${process.integrations.join(", ")}</span>
                        </div>
                        `
                            : ""
                        }
                    </div>

                    <div class="tags-container">
                        <div class="tags-title">Tags:</div>
                        <div class="tags">
                            ${process.tags.map((tag) => `<span class="tag" onclick="event.stopPropagation(); searchByTag('${tag}')">${tag}</span>`).join("")}
                        </div>
                    </div>

                    ${
                      process.diagram
                        ? `
                    <div class="diagram-section">
                        <img src="../diagrams/${process.diagram}"
                             alt="${process.name}"
                             class="diagram-image"
                             onclick="event.stopPropagation(); showDiagram('${process.diagram}', '${process.name}')"
                             style="max-height: 200px; cursor: pointer;">
                    </div>
                    `
                        : `
                    <div class="diagram-section">
                        <div class="diagram-placeholder">No hi ha diagrama disponible</div>
                    </div>
                    `
                    }
                </div>
            `
          )
          .join("");
      }

      // Cerca per tag
      function searchByTag(tag) {
        document.getElementById("searchInput").value = tag;
        filterProcesses();
      }

      // Filtres des del sidebar
      function filterByCategory(category) {
        document.getElementById("categoryFilter").value = category;
        filterProcesses();
        updateActiveNavItem(event.target);
      }

      function filterByIntegration(integration) {
        document.getElementById("integrationFilter").value = integration;
        filterProcesses();
        updateActiveNavItem(event.target);
      }

      function updateActiveNavItem(element) {
        // Treure active de tots els nav-items
        document.querySelectorAll(".nav-item").forEach((item) => {
          item.classList.remove("active");
        });
        // Afegir active al clicat
        element.classList.add("active");
      }

      // Toggle sidebar

      // Mostrar diagrama en modal
      function showDiagram(diagramPath, title) {
        const modal = document.getElementById("diagramModal");
        const modalTitle = document.getElementById("modalTitle");
        const modalImage = document.getElementById("modalImage");

        modalTitle.textContent = title;
        modalImage.src = `../diagrams/${diagramPath}`;
        modal.style.display = "block";
      }

      // Tancar modal
      function closeModal() {
        document.getElementById("diagramModal").style.display = "none";
      }

      // Mostrar detalls del proc√©s
      function showProcessDetails(processId) {
        const process = processesData.find((p) => p.id === processId);
        if (process) {
          const content = `
                    <h4>${process.name}</h4>
                    <p><strong>Descripci√≥:</strong> ${process.description}</p>
                    <p><strong>Categoria:</strong> ${process.category}</p>
                    <p><strong>Mecanisme:</strong> ${process.mechanism}</p>
                    <p><strong>Objectes:</strong> ${process.objects.join(", ")}</p>
                    ${process.integrations.length > 0 ? `<p><strong>Integracions:</strong> ${process.integrations.join(", ")}</p>` : ""}
                    <p><strong>Prioritat:</strong> ${process.priority}</p>
                    <p><strong>Complexitat:</strong> ${process.complexity}</p>
                    <p><strong>Tags:</strong> ${process.tags.join(", ")}</p>
                    ${process.documentation ? `<p><strong>Documentaci√≥:</strong> <a href="${process.documentation}" target="_blank">Veure documentaci√≥</a></p>` : ""}
                `;
          openPanel(process.name, content);
        }
      }

      // Canviar vista
      function setView(view) {
        currentView = view;
        document
          .querySelectorAll(".view-btn")
          .forEach((btn) => btn.classList.remove("active"));
        event.target.classList.add("active");
        renderProcesses();
      }

      // Actualitzar comptador de resultats
      function updateResultsCount() {
        const count = filteredProcesses.length;
        const total = processesData.length;
        document.getElementById("resultsCount").textContent =
          `${count} de ${total} processos`;
      }

      // Event listeners
      document
        .getElementById("searchInput")
        .addEventListener("input", filterProcesses);
      document
        .getElementById("categoryFilter")
        .addEventListener("change", filterProcesses);
      document
        .getElementById("mechanismFilter")
        .addEventListener("change", filterProcesses);
      document
        .getElementById("objectFilter")
        .addEventListener("change", filterProcesses);
      document
        .getElementById("integrationFilter")
        .addEventListener("change", filterProcesses);

      // Tancar modal en clicar fora
      window.onclick = function (event) {
        const modal = document.getElementById("diagramModal");
        if (event.target === modal) {
          modal.style.display = "none";
        }
      };

      // Tancar panell amb Escape
      document.addEventListener("keydown", function (e) {
        if (e.key === "Escape") {
          closePanel();
        }
      });

      // Carregar dades quan es carrega la p√†gina
      document.addEventListener("DOMContentLoaded", function () {
        restorePanelStates();
        loadData();
        initRightPanelResize();
      });
    </script>
  </body>
</html>
